{% extends 'gliocas_app/base.html' %}
{% load upvotescore %}

{% block title_block %}
{{ question.title }}
{% endblock %}

{% block body_block %}
<h1 class="mt-1"> <a href="{% url 'show_subject' subject.slug %}"> {{ subject.name }}</a> </h1>
<h1 class="mt-1"> <a href="{% url 'show_course' subject.slug course.slug %}"> {{ course.name}}</a> </h1>



<div class="card my-3 rounded shadow">
    <div class="card-body">
        <div class="mb-5">
            <h2 class="card-title"> {{ question.title }} </h2>
            <p class="card-subtitle text-muted">
                by <a href="{% url 'user' question.poster.username %}">{{ question.poster }}</a> at {{ question.date }}
                <br/>
                {% questionscore question %} upvotes {{question.views}} views
            </p>
            <hr />
            <p> {{ question.text }} </p>
            {% if question.picture %}
            <img src="{{ MEDIA_URL }}{{ question.picture }}" class="img-thumbnail" alt="image" />
            {% endif %}
        </div>
        <a href="{% url 'answer_question' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug %}">Answer</a>
        <a href="{% url 'like_question' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug like='1' %}">Like</a>
        <a href="{% url 'like_question' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug like='0' %}">Dislike</a>
		{% if user.is_authenticated %}
			You have {% questionVoted question user %} this
		{% endif %}
        <input type="submit" name="submit" value="Add Reply" />
        </form>
        <h4># answers</h4>
        <hr />
        {% if answers %}
        <ul>
            {% for answer in answers %}
            <li><a href="{% url 'user' answer.poster.username %}">{{answer.poster}}</a> - {% answerscore answer %} - {{ answer.text }}</li>
            {% if answer.picture %}
            <img src="{{ MEDIA_URL }}{{ answer.picture }}" width="auto" height="300" alt="Picture" />
            {% endif %}
            <a href="{% url 'like_answer' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug answer_key=answer.pk like='1' %}">
                Like</a>
            <a href="{% url 'like_answer' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug answer_key=answer.pk like='0' %}">
                Dislike</a></br>
			{% if user.is_authenticated %}
				You have {% answerVoted answer user %} this
			{% endif %}
            {% for reply in replies %}
            {% if reply.answer.pk == answer.pk %}
            <p style="padding-left: 50px;"><a href="{% url 'user' reply.poster.username %}">{{reply.poster}}</a> - {% replyscore reply %} - {{ reply.text }}</br>
                <a href="{% url 'like_reply' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug reply_key=reply.pk like='1' %}">
                    Like</a>
                <a href="{% url 'like_reply' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug reply_key=reply.pk like='0' %}">
                    Dislike</a></br>
				{% if user.is_authenticated %}
					You have {% replyVoted reply user %} this
				{% endif %}
			</p>
            {% endif %}
            {% endfor %}
            <a href="{% url 'reply_answer' subject_slug=subject.slug course_slug=course.slug question_slug=question.slug answer_key=answer.pk %}">Reply</a>
            {% endfor %}
        </ul>
        {% else %}

        <strong>Be the first one to comment!</strong>
        {% endif %}

    </div>
</div>
{% endblock %}